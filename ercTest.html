<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ECR亲密关系经历量表测试</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background-color: #f5f7fa;
            color: #333;
            line-height: 1.6;
            padding: 20px;
            max-width: 1200px;
            margin: 0 auto;
        }
        
        .container {
            display: flex;
            flex-direction: column;
            gap: 30px;
        }
        
        header {
            text-align: center;
            padding: 30px 20px;
            background: linear-gradient(135deg, #6a11cb 0%, #2575fc 100%);
            color: white;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(106, 17, 203, 0.2);
        }
        
        h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
        }
        
        .subtitle {
            font-size: 1.2rem;
            opacity: 0.9;
            max-width: 800px;
            margin: 0 auto;
        }
        
        .test-section {
            display: flex;
            flex-wrap: wrap;
            gap: 30px;
        }
        
        .instructions, .results-section {
            flex: 1;
            min-width: 300px;
            background-color: white;
            padding: 25px;
            border-radius: 15px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05);
        }
        
        .questionnaire {
            flex: 2;
            min-width: 300px;
            background-color: white;
            padding: 25px;
            border-radius: 15px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05);
        }
        
        h2 {
            color: #2575fc;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 2px solid #f0f0f0;
        }
        
        h3 {
            color: #444;
            margin: 15px 0 10px;
        }
        
        ul {
            padding-left: 20px;
            margin-bottom: 20px;
        }
        
        li {
            margin-bottom: 8px;
        }
        
        .question-item {
            margin-bottom: 25px;
            padding-bottom: 20px;
            border-bottom: 1px solid #f0f0f0;
        }
        
        .question-text {
            font-weight: 500;
            margin-bottom: 15px;
            color: #333;
        }
        
        .scale-labels {
            display: flex;
            justify-content: space-between;
            margin-bottom: 10px;
            font-size: 0.85rem;
            color: #666;
        }
        
        .scale-options {
            display: flex;
            justify-content: space-between;
            margin-bottom: 10px;
        }
        
        .scale-option {
            display: flex;
            flex-direction: column;
            align-items: center;
            flex: 1;
        }
        
        .scale-option input[type="radio"] {
            margin-bottom: 5px;
            width: 20px;
            height: 20px;
        }
        
        .scale-number {
            font-weight: bold;
            color: #2575fc;
            font-size: 1.1rem;
        }
        
        .buttons {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-top: 30px;
        }
        
        button {
            padding: 14px 28px;
            border: none;
            border-radius: 50px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        #submitBtn {
            background: linear-gradient(to right, #6a11cb, #2575fc);
            color: white;
        }
        
        #resetBtn {
            background-color: #f0f0f0;
            color: #666;
        }
        
        button:hover {
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }
        
        #submitBtn:hover {
            box-shadow: 0 5px 15px rgba(106, 17, 203, 0.3);
        }
        
        .results-container {
            display: none;
            margin-top: 20px;
            animation: fadeIn 0.8s ease;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        
        .score-display {
            display: flex;
            gap: 20px;
            margin: 25px 0;
            flex-wrap: wrap;
        }
        
        .score-box {
            flex: 1;
            min-width: 200px;
            text-align: center;
            padding: 20px;
            border-radius: 10px;
            background-color: #f9f9f9;
            border-left: 5px solid #2575fc;
        }
        
        .score-value {
            font-size: 2.5rem;
            font-weight: bold;
            color: #2575fc;
            margin: 10px 0;
        }
        
        .attachment-type {
            text-align: center;
            padding: 30px;
            margin: 25px 0;
            border-radius: 15px;
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
        }
        
        .type-title {
            font-size: 2rem;
            color: #2575fc;
            margin-bottom: 15px;
        }
        
        .type-description {
            max-width: 800px;
            margin: 0 auto;
            font-size: 1.1rem;
            line-height: 1.8;
        }
        
        .visualization {
            display: flex;
            justify-content: center;
            margin: 30px 0;
        }
        
        .attachment-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            grid-template-rows: 1fr 1fr;
            gap: 2px;
            width: 300px;
            height: 300px;
            background-color: #f0f0f0;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }
        
        .grid-cell {
            display: flex;
            align-items: center;
            justify-content: center;
            text-align: center;
            padding: 10px;
            font-weight: 600;
            transition: all 0.3s ease;
        }
        
        .active-cell {
            transform: scale(1.05);
            box-shadow: 0 0 20px rgba(37, 117, 252, 0.3);
            z-index: 2;
        }
        
        .secure {
            background-color: #e8f5e9;
            color: #2e7d32;
        }
        
        .preoccupied {
            background-color: #fff3e0;
            color: #f57c00;
        }
        
        .dismissing {
            background-color: #e3f2fd;
            color: #1976d2;
        }
        
        .fearful {
            background-color: #fce4ec;
            color: #c2185b;
        }
        
        .axis-label {
            position: absolute;
            font-weight: 600;
            color: #666;
        }
        
        .anxiety-axis {
            bottom: -30px;
            left: 50%;
            transform: translateX(-50%);
        }
        
        .avoidance-axis {
            top: 50%;
            left: -40px;
            transform: translateY(-50%) rotate(-90deg);
        }
        
        .axis-container {
            position: relative;
        }
        
        .discriminant-scores {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            margin-top: 25px;
            justify-content: center;
        }
        
        .discriminant-score {
            background-color: white;
            border-radius: 10px;
            padding: 15px;
            text-align: center;
            min-width: 180px;
            box-shadow: 0 3px 10px rgba(0, 0, 0, 0.08);
            border: 2px solid transparent;
        }
        
        .discriminant-score.highest {
            border-color: #2575fc;
            background-color: #f0f7ff;
        }
        
        .discriminant-score .score-name {
            font-weight: 600;
            margin-bottom: 8px;
            color: #333;
        }
        
        .discriminant-score .score-value {
            font-size: 1.8rem;
            color: #2575fc;
            margin: 0;
        }
        
        footer {
            text-align: center;
            margin-top: 40px;
            padding-top: 20px;
            border-top: 1px solid #eee;
            color: #777;
            font-size: 0.9rem;
        }
        
        .progress-container {
            margin-bottom: 25px;
        }
        
        .progress-bar {
            height: 8px;
            background-color: #e0e0e0;
            border-radius: 4px;
            overflow: hidden;
        }
        
        .progress-fill {
            height: 100%;
            background: linear-gradient(to right, #6a11cb, #2575fc);
            width: 0%;
            transition: width 0.5s ease;
        }
        
        .progress-text {
            text-align: right;
            font-size: 0.9rem;
            color: #666;
            margin-top: 5px;
        }
        
        .error-message {
            color: #ff4757;
            text-align: center;
            margin-top: 15px;
            font-weight: 500;
            display: none;
        }
        
        @media (max-width: 768px) {
            .test-section {
                flex-direction: column;
            }
            
            .scale-options {
                flex-wrap: wrap;
            }
            
            .scale-option {
                min-width: 20%;
                margin-bottom: 10px;
            }
            
            h1 {
                font-size: 2rem;
            }
            
            .score-box {
                min-width: 100%;
            }
            
            .discriminant-score {
                min-width: 100%;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>ECR亲密关系经历量表测试</h1>
            <p class="subtitle">成人依恋量表-亲密关系经历量表(Experiences in Close Relationships Inventory)</p>
        </header>
        
        <div class="test-section">
            <div class="instructions">
                <h2><i class="fas fa-info-circle"></i> 测试说明</h2>
                <p>下面给出了许多句子，都是描述恋爱关系中的每个人可能会有的感觉。在你的恋爱关系中，你自己的一般体验与每个句子描述的情况相似的地方有多大?</p>
                <p>注意，这里并不仅仅是指现在的恋爱经历，它针对的是你所有恋爱经历中常常体验到的感觉。</p>
                
                <h3>评分标准</h3>
                <div class="scale-labels" style="justify-content: space-around; margin-top: 10px;">
                    <div style="text-align: center;">
                        <div class="scale-number">1</div>
                        <div>非常不同意</div>
                    </div>
                    <div style="text-align: center;">
                        <div class="scale-number">4</div>
                        <div>中立</div>
                    </div>
                    <div style="text-align: center;">
                        <div class="scale-number">7</div>
                        <div>非常同意</div>
                    </div>
                </div>
                
                <h3>依恋类型说明</h3>
                <p>ECR量表评估两个维度：<strong>回避</strong>和<strong>焦虑</strong>，根据费舍尔线性判别公式计算四种依恋类型：</p>
                <ul>
                    <li><strong>安全型</strong>: 低焦虑、低回避</li>
                    <li><strong>专注型(痴迷型)</strong>: 高焦虑、低回避</li>
                    <li><strong>冷漠型(疏离型)</strong>: 低焦虑、高回避</li>
                    <li><strong>恐惧型</strong>: 高焦虑、高回避</li>
                </ul>
                
                <div class="visualization">
                    <div class="axis-container">
                        <div class="attachment-grid" id="attachmentGrid">
                            <div class="grid-cell secure" data-type="secure">安全型<br>低焦虑、低回避</div>
                            <div class="grid-cell preoccupied" data-type="preoccupied">专注型<br>高焦虑、低回避</div>
                            <div class="grid-cell dismissing" data-type="dismissing">冷漠型<br>低焦虑、高回避</div>
                            <div class="grid-cell fearful" data-type="fearful">恐惧型<br>高焦虑、高回避</div>
                        </div>
                        <div class="axis-label anxiety-axis">焦虑维度 →</div>
                        <div class="axis-label avoidance-axis">回避维度 →</div>
                    </div>
                </div>
                
                <h3>计分方法</h3>
                <ol>
                    <li>分别计算两个维度总得分</li>
                    <li>计算两个维度的平均分</li>
                    <li>使用费舍尔线性判别公式计算四种类型的得分</li>
                    <li>得分最高的类型即为您的依恋类型</li>
                </ol>
            </div>
            
            <div class="questionnaire">
                <h2><i class="fas fa-question-circle"></i> 问卷</h2>
                
                <div class="progress-container">
                    <div class="progress-bar">
                        <div class="progress-fill" id="progressFill"></div>
                    </div>
                    <div class="progress-text">已完成 <span id="answeredCount">0</span>/36 题</div>
                </div>
                
                <div id="questionsContainer">
                    <!-- 问题将通过JavaScript动态生成 -->
                </div>
                
                <div class="error-message" id="errorMessage">
                    请回答所有问题后再提交
                </div>
                
                <div class="buttons">
                    <button id="submitBtn"><i class="fas fa-chart-bar"></i> 查看结果</button>
                    <button id="resetBtn"><i class="fas fa-redo"></i> 重新开始</button>
                </div>
                
                <div class="results-container" id="resultsContainer">
                    <h2><i class="fas fa-poll"></i> 测试结果</h2>
                    
                    <div class="score-display">
                        <div class="score-box">
                            <h3>回避维度得分</h3>
                            <div class="score-value" id="avoidanceScore">0.0</div>
                            <p>平均分：<span id="avoidanceMean">0.0</span></p>
                            <p>分数越高表示您在亲密关系中越倾向于回避亲密</p>
                        </div>
                        
                        <div class="score-box">
                            <h3>焦虑维度得分</h3>
                            <div class="score-value" id="anxietyScore">0.0</div>
                            <p>平均分：<span id="anxietyMean">0.0</span></p>
                            <p>分数越高表示您在亲密关系中越容易感到焦虑</p>
                        </div>
                    </div>
                    
                    <div class="attachment-type" id="attachmentTypeResult">
                        <div class="type-title" id="typeTitle">安全型依恋</div>
                        <div class="type-description" id="typeDescription">
                            安全型依恋的个体在亲密关系中感到舒适，既能与他人建立亲密关系，也能保持独立。他们通常对关系有积极的看法，信任伴侣，并能有效处理关系中的冲突。
                        </div>
                    </div>
                    
                    <h3>费舍尔判别函数得分</h3>
                    <div class="discriminant-scores" id="discriminantScores">
                        <!-- 判别得分将通过JavaScript动态生成 -->
                    </div>
                    
                    <div class="visualization">
                        <div class="axis-container">
                            <div class="attachment-grid" id="resultGrid">
                                <div class="grid-cell secure" data-type="secure">安全型</div>
                                <div class="grid-cell preoccupied" data-type="preoccupied">专注型</div>
                                <div class="grid-cell dismissing" data-type="dismissing">冷漠型</div>
                                <div class="grid-cell fearful" data-type="fearful">恐惧型</div>
                            </div>
                            <div class="axis-label anxiety-axis">焦虑维度 →</div>
                            <div class="axis-label avoidance-axis">回避维度 →</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <footer>
            <p>ECR量表(Experiences in Close Relationships Inventory)由Brennan, Clark和Shaver于1998年编制</p>
            <p>本测试结果仅供参考，不能替代专业心理评估</p>
        </footer>
    </div>

    <script>
        // ECR量表问题数据 - 根据文档内容，已移除(R)标记
        const ecrQuestions = [
            { text: "总的来说,我不喜欢让恋人知道自己内心深处的感觉；", dimension: "avoidance", reverse: false },
            { text: "我担心我会被抛弃；", dimension: "anxiety", reverse: false },
            { text: "我觉得跟恋人亲近是一件惬意的事情；", dimension: "avoidance", reverse: true },
            { text: "我很担心我的恋爱关系；", dimension: "anxiety", reverse: false },
            { text: "当恋人开始要跟我亲近时,我发现我自己在退缩；", dimension: "avoidance", reverse: false },
            { text: "我担心恋人不会象我关心他(/她)那样地关心我；", dimension: "anxiety", reverse: false },
            { text: "当恋人希望跟我非常亲近时,我会觉得不自在；", dimension: "avoidance", reverse: false },
            { text: "我有点担心会失去恋人；", dimension: "anxiety", reverse: false },
            { text: "我觉得对恋人开诚布公,不是一件很舒服的事情；", dimension: "avoidance", reverse: false },
            { text: "我常常希望恋人对我的感情和我对恋人的感情一样强烈；", dimension: "anxiety", reverse: false },
            { text: "我想与恋人亲近,但我又总是会退缩不前；", dimension: "avoidance", reverse: false },
            { text: "我常常想与恋人形影不离,但有时这样会把恋人吓跑；", dimension: "anxiety", reverse: false },
            { text: "当恋人跟我过分亲密的时候,我会感到内心紧张；", dimension: "avoidance", reverse: false },
            { text: "我担心一个人独处；", dimension: "anxiety", reverse: false },
            { text: "我愿意把我内心的想法和感觉告诉恋人,我觉得这是一件自在的事情；", dimension: "avoidance", reverse: true },
            { text: "我想跟恋人非常亲密的愿望,有时会把恋人吓跑；", dimension: "anxiety", reverse: false },
            { text: "我试图避免与恋人变得太亲近；", dimension: "avoidance", reverse: false },
            { text: "我需要我的恋人一再地保证他/她是爱我的；", dimension: "anxiety", reverse: false },
            { text: "我觉得我比较容易与恋人亲近；", dimension: "avoidance", reverse: true },
            { text: "我觉得自己在要求恋人把更多的感觉,以及对恋爱关系的投入程度表现出来；", dimension: "anxiety", reverse: false },
            { text: "我发现让我依赖恋人,是一件困难的事情；", dimension: "avoidance", reverse: false },
            { text: "我并不是常常担心被恋人抛弃；", dimension: "anxiety", reverse: true },
            { text: "我倾向于不跟恋人过分亲密；", dimension: "avoidance", reverse: false },
            { text: "如果我无法得到恋人的注意和关心,我会心烦意乱或者生气；", dimension: "anxiety", reverse: false },
            { text: "我跟恋人什么事情都讲；", dimension: "avoidance", reverse: true },
            { text: "我发现恋人并不愿意象我所想的那样跟我亲近；", dimension: "anxiety", reverse: false },
            { text: "我经常与恋人讨论我所遇到的问题以及我关心的事情；", dimension: "avoidance", reverse: true },
            { text: "如果我还没有恋人的话,我会感到有点焦虑和不安；", dimension: "anxiety", reverse: false },
            { text: "我觉得依赖恋人是很自在的事情；", dimension: "avoidance", reverse: true },
            { text: "如果恋人不能象我所希望的那样在我身边时,我会感到灰心丧气；", dimension: "anxiety", reverse: false },
            { text: "我并不在意从恋人那里寻找安慰,听取劝告,得到帮助；", dimension: "avoidance", reverse: true },
            { text: "如果在我需要的时候,恋人却不在我身边,我会感到沮丧；", dimension: "anxiety", reverse: false },
            { text: "在需要的时候,我向恋人求助,是很有用的；", dimension: "avoidance", reverse: true },
            { text: "当恋人不赞同我时,我觉得确实是我不好；", dimension: "anxiety", reverse: false },
            { text: "我会在很多事情上向恋人求助,包括寻求安慰和得到承诺；", dimension: "avoidance", reverse: true },
            { text: "当恋人不花时间和我在一起时,我会感到怨恨；", dimension: "anxiety", reverse: false }
        ];
        
        // 初始化用户答案数组
        let userAnswers = new Array(ecrQuestions.length).fill(0);
        
        // 页面加载完成后初始化问卷
        document.addEventListener('DOMContentLoaded', function() {
            initQuestionnaire();
            updateProgress();
            
            // 提交按钮事件
            document.getElementById('submitBtn').addEventListener('click', calculateResults);
            
            // 重置按钮事件
            document.getElementById('resetBtn').addEventListener('click', resetTest);
        });
        
        // 初始化问卷
        function initQuestionnaire() {
            const container = document.getElementById('questionsContainer');
            
            ecrQuestions.forEach((question, index) => {
                const questionItem = document.createElement('div');
                questionItem.className = 'question-item';
                
                // 注意：已移除反向计分标识
                questionItem.innerHTML = `
                    <div class="question-text">${index + 1}. ${question.text}</div>
                    <div class="scale-labels">
                        <span>非常不同意</span>
                        <span>中立</span>
                        <span>非常同意</span>
                    </div>
                    <div class="scale-options">
                        ${[1, 2, 3, 4, 5, 6, 7].map(num => `
                            <div class="scale-option">
                                <input type="radio" 
                                       id="q${index}_${num}" 
                                       name="q${index}" 
                                       value="${num}"
                                       data-index="${index}"
                                       data-value="${num}">
                                <label for="q${index}_${num}" class="scale-number">${num}</label>
                            </div>
                        `).join('')}
                    </div>
                `;
                
                container.appendChild(questionItem);
                
                // 为每个单选按钮添加事件监听器
                const radioButtons = questionItem.querySelectorAll('input[type="radio"]');
                radioButtons.forEach(radio => {
                    radio.addEventListener('change', function() {
                        const questionIndex = parseInt(this.getAttribute('data-index'));
                        const value = parseInt(this.value);
                        userAnswers[questionIndex] = value;
                        updateProgress();
                        
                        // 隐藏错误消息
                        document.getElementById('errorMessage').style.display = 'none';
                    });
                });
            });
        }
        
        // 更新进度条
        function updateProgress() {
            const answeredCount = userAnswers.filter(answer => answer !== 0).length;
            const progressPercentage = (answeredCount / ecrQuestions.length) * 100;
            
            document.getElementById('answeredCount').textContent = answeredCount;
            document.getElementById('progressFill').style.width = `${progressPercentage}%`;
        }
        
        // 计算测试结果
        function calculateResults() {
            // 检查是否所有问题都已回答
            if (userAnswers.includes(0)) {
                document.getElementById('errorMessage').style.display = 'block';
                return;
            }
            
            // 计算回避和焦虑维度得分
            let avoidanceSum = 0;
            let anxietySum = 0;
            
            // 回避维度问题索引：0,2,4,...,34 (偶数索引，从0开始)
            // 焦虑维度问题索引：1,3,5,...,35 (奇数索引，从0开始)
            
            for (let i = 0; i < ecrQuestions.length; i++) {
                const question = ecrQuestions[i];
                let answer = userAnswers[i];
                
                // 反向计分处理（不显示给用户）
                if (question.reverse) {
                    answer = 8 - answer; // 7点量表中，反向计分公式为 8 - 原始分
                }
                
                if (question.dimension === "avoidance") {
                    avoidanceSum += answer;
                } else {
                    anxietySum += answer;
                }
            }
            
            // 计算平均分
            const avoidanceMean = (avoidanceSum / 18).toFixed(2);
            const anxietyMean = (anxietySum / 18).toFixed(2);
            
            // 显示结果
            document.getElementById('avoidanceScore').textContent = avoidanceSum;
            document.getElementById('avoidanceMean').textContent = avoidanceMean;
            document.getElementById('anxietyScore').textContent = anxietySum;
            document.getElementById('anxietyMean').textContent = anxietyMean;
            
            // 使用费舍尔线性判别公式计算四种类型得分
            const A = parseFloat(avoidanceMean);
            const B = parseFloat(anxietyMean);
            
            const M1 = A * 3.2893296 + B * 5.4725318 - 11.5307833; // 安全性
            const M2 = A * 7.2371075 + B * 8.1776448 - 32.3553266; // 恐惧性
            const M3 = A * 3.9246754 + B * 9.7102446 - 28.4573220; // 专注性
            const M4 = A * 7.3654621 + B * 4.9392039 - 22.2281088; // 冷漠性
            
            // 找出最高分
            const scores = [
                { name: "安全型", value: M1, type: "secure" },
                { name: "恐惧型", value: M2, type: "fearful" },
                { name: "专注型", value: M3, type: "preoccupied" },
                { name: "冷漠型", value: M4, type: "dismissing" }
            ];
            
            const highestScore = scores.reduce((max, score) => score.value > max.value ? score : max);
            
            // 显示判别函数得分
            const discriminantContainer = document.getElementById('discriminantScores');
            discriminantContainer.innerHTML = '';
            
            scores.forEach(score => {
                const scoreDiv = document.createElement('div');
                scoreDiv.className = `discriminant-score ${score.type === highestScore.type ? 'highest' : ''}`;
                scoreDiv.innerHTML = `
                    <div class="score-name">${score.name}</div>
                    <div class="score-value">${score.value.toFixed(4)}</div>
                `;
                discriminantContainer.appendChild(scoreDiv);
            });
            
            // 确定依恋类型
            const attachmentType = highestScore.type;
            
            // 显示结果区域
            document.getElementById('resultsContainer').style.display = 'block';
            
            // 滚动到结果区域
            document.getElementById('resultsContainer').scrollIntoView({ behavior: 'smooth' });
            
            // 高亮显示对应的网格单元格
            highlightAttachmentGrid(attachmentType);
            
            // 更新结果网格
            highlightResultGrid(attachmentType);
            
            // 更新类型描述
            updateTypeDescription(attachmentType);
        }
        
        // 高亮显示对应的网格单元格
        function highlightAttachmentGrid(type) {
            // 移除所有单元格的高亮
            document.querySelectorAll('#attachmentGrid .grid-cell').forEach(cell => {
                cell.classList.remove('active-cell');
            });
            
            // 高亮当前类型
            document.querySelector(`#attachmentGrid .grid-cell[data-type="${type}"]`).classList.add('active-cell');
        }
        
        // 高亮显示结果网格
        function highlightResultGrid(type) {
            // 移除所有单元格的高亮
            document.querySelectorAll('#resultGrid .grid-cell').forEach(cell => {
                cell.classList.remove('active-cell');
            });
            
            // 高亮当前类型
            document.querySelector(`#resultGrid .grid-cell[data-type="${type}"]`).classList.add('active-cell');
        }
        
        // 更新类型描述
        function updateTypeDescription(type) {
            const typeTitles = {
                secure: "安全型依恋",
                preoccupied: "专注型(痴迷型)依恋",
                dismissing: "冷漠型(疏离型)依恋",
                fearful: "恐惧型依恋"
            };
            
            const typeDescriptions = {
                secure: "安全型依恋的个体在亲密关系中感到舒适，既能与他人建立亲密关系，也能保持独立。他们通常对关系有积极的看法，信任伴侣，并能有效处理关系中的冲突。安全型依恋的个体通常拥有更稳定、满意的亲密关系。",
                preoccupied: "专注型(痴迷型)依恋的个体渴望亲密关系，但常常担心伴侣是否同样爱自己。他们可能会过度寻求认可和安慰，对关系中的小变化非常敏感。这类个体可能表现出较强的占有欲，并倾向于过度分析关系中的互动。",
                dismissing: "冷漠型(疏离型)依恋的个体重视独立和自给自足，可能避免过于亲密的关系。他们倾向于压抑情感需求，可能认为依赖他人是软弱的表现。这类个体通常在关系中有较强的界限，并可能回避深层次的情感交流。",
                fearful: "恐惧型依恋的个体既渴望亲密关系，又害怕受到伤害。他们可能在亲近和疏远之间摇摆不定，对亲密关系持有矛盾的态度。这类个体常常担心被拒绝或抛弃，但又不愿意完全依赖他人。"
            };
            
            document.getElementById('typeTitle').textContent = typeTitles[type];
            document.getElementById('typeDescription').textContent = typeDescriptions[type];
        }
        
        // 重置测试
        function resetTest() {
            // 重置答案数组
            userAnswers = new Array(ecrQuestions.length).fill(0);
            
            // 重置所有单选按钮
            document.querySelectorAll('input[type="radio"]').forEach(radio => {
                radio.checked = false;
            });
            
            // 隐藏结果
            document.getElementById('resultsContainer').style.display = 'none';
            
            // 隐藏错误消息
            document.getElementById('errorMessage').style.display = 'none';
            
            // 重置网格高亮
            document.querySelectorAll('.grid-cell').forEach(cell => {
                cell.classList.remove('active-cell');
            });
            
            // 清除判别得分
            document.getElementById('discriminantScores').innerHTML = '';
            
            // 更新进度
            updateProgress();
            
            // 滚动到顶部
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }
    </script>
</body>
</html
